<!doctype html>
<html>
<head>
	<title></title>
	<meta charset="utf-8">
	<title>Frontend backend connector</title>
	<link rel="stylesheet" href="jquery-ui-1.12.1.custom\jquery-ui.css"/>
	<script src="jquery-ui-1.12.1.custom\	external\jquery\jquery.js"></script>
	<script src="jquery-ui-1.12.1.custom\jquery-ui.js"></script>
	<script>
	;(function() {
		"use strict";
			$( document ).ready( function() {
				var projectsArr=[];
				var currentProject;
				var currentDialog;
				var newProjectForm;

//---------------------CLASS PROJECT----------------------
				var Project=function (name,description){
					this.name=name;
					this.description=description;
					//add call
				}

//jQuery UI
				//$( '#projectName' ).css( 'color', 'red' );
				//console.log("project name2: ", $("#projectName").val(''));
				$('input').addClass("ui-widget ui-widget-content ui-corner-all");
				$('textarea').addClass("ui-widget  ui-corner-all");
				$('label').addClass("ui-widget ");


//------------------CHOOSE PROJECT-----------------------------------
		$('#chooseProject').selectmenu({
      change: function( event, data ) {

				console.log("combobox value project id: ", data.item.value);
				/*
				circle.css({
          width: data.item.value,
          height: data.item.value
        });
				*/
      }
		}).selectmenu( "menuWidget" )
    .addClass( "overflow" ); //select menu

		//update project list from server:
var updateProjetList = function (){
	console.log("updateprojectlist program läuft");
	$.ajax({
	url:'http://localhost:26893/projectsND',
	method:'get',
	//answer data from server:
	dataType: 'json',
	success:function( data ){
			//console.log(data.projects);
			for (var i=0;i<data.projects.length;i++){

				console.log(data.projects[i].name);
				$('<option>')
				.html(data.projects[i].name)
				.attr("value",data.projects[i].id)
				.attr("title",data.projects[i].description)
				.appendTo('#chooseProject');

			}


	}
}); //ajax

}

updateProjetList();
console.log("main program läuft");

//-------------------NEW PROJECT DIALOG-------------------------------
newProjectForm=		$( "#newProjectForm" ).dialog({

						autoOpen: false,
						resizable: false,
						modal: true,
						title: "Add new project",
			      show: {
							create: function( event, ui ) {},
			        effect: "blind",
			        duration: 1000
			      },
			      hide: {
			        effect: "size",
			        duration: 1000
			      },
						buttons: {
			        "Create project": function() {



								currentDialog="#newProjectForm";
								$( '#saveConfirm').dialog("open");
			          //$( this ).dialog( "close" );
								//create code!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
			        },
			        Cancel: function() {
								currentDialog="#newProjectForm";
								$( '#cancelConfirm').dialog("open");

					    }
			      }, //end of buttons

				}); //end new project dialog
//-------------------CANCEL CONFIRM DIALOG-------------------------------
	$( "#cancelConfirm" ).dialog({
			      autoOpen: false,
						resizable: false,
						modal: true,
						title: "Cancel confirmation",
			      show: {
			        effect: "blind",
			        duration: 1000
			      },
			      hide: {
			        effect: "size",
			        duration: 1000
			      },
						buttons: {
			        "Yes": function() {
								$(currentDialog).dialog("close" );
			          $( this ).dialog( "close" );
								//create code cancel without saving!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
			        },
			        "No": function() {
								$( this ).dialog( "close" );
					    }
			      } //end of buttons
				}); //end new project dialog

				$( "#saveConfirm" ).dialog({
			      autoOpen: false,
						resizable: false,
						modal: true,
						title: "Confirm saving",
			      show: {
			        effect: "blind",
			        duration: 1000
			      },
			      hide: {
			        effect: "size",
			        duration: 1000
			      },
						buttons: {
			        "Yes": function() {
								switch (currentDialog) {
									case "#newProjectForm":
										var newProjectObject = new Project($('#projectName').val(),$('#projectDetail').val());
											$.ajax({
											url:'http://localhost:26893/projectsND',
											method:'post',
											//answer data from server:
											dataType: 'json',
											//sending data
											data:{dataObject:JSON.stringify(newProjectObject)},
											/*data:JSON.stringify(jsonRoot),*/
											success:function( data ){
												console.log("saveNewproject");
												console.log(data);
												//return data;
											}
										}); //ajax

								} //switch end of
								$(currentDialog).dialog("close" );
			          $( this ).dialog( "close" );
								//create code cancel without saving!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
			        },
			        "No": function() {
								$( this ).dialog( "close" );
					    }
			      } //end of buttons
				}); //end new project dialog

			$(document).tooltip({
					show: {
	        effect: "slideDown",
	        delay: 250
	      }
	    });
			$("#accProjects").accordion({
				heightStyle: "content"
			});
			//$("#addProject").button();

//------------------open newProjectForm----------------------------------------

			 //currentProject=new Project(6,"project7","Das projekt macht nichts, aber um so mehr ordentlich");

			$('#addProjectBtn').button().on('click', function(){
				$("#projectName").val('');
				$("#projectDetail").val('');
				console.log("felder in form initialisiert");


				$( "#newProjectForm" ).dialog( "open" );
			});

		}) //document ready
	}()); //outer-function
	</script>
	<style>
	body > div:first-of-type {
		padding:0;
		text-align: center;
	}

	.wrapMainBlock {
		margin: 5%;
		border-radius: 10px;
		padding: 10px;
		background: #F1F1F1;
		border: 1px solid #F6F1E6;
	}

	#addProjectBtn {
		margin: 20px 10px 0  0;
	}

	label {
      display: block;
      margin:  0  0 15px 0;
    }
	  .overflow { height: 200px; }

	</style>
</head>
<body>
<div class="wrapMainBlock">
	<h2>API DOC</h2>
</div>



<div class="wrapMainBlock">
	<label for="chooseProject">Select a project: </label>
    <select name="chooseProject" id="chooseProject">


    </select>


	<br><button id="addProjectBtn">new project</button>
</div>

<div class="wrapMainBlock">


		<div id="accProjects">
			<h3>default project</h3>
			<div>
					project template nr. 1
					project template nr. 1
					project template nr. 1
			</div>
			<h3>default project2</h3>
			<div>
					project template nr. 2
					project template nr. 2
					project template nr. 2
			</div>

		</div>
</div>

<div id="newProjectForm" title="Create new project">
  <label for="projectName">Name: </label><input type="text" id="projectName" maxlength="18" autocomplete="off" value="">
  <label for="projectDetail">Detail: </label><textarea rows="4" cols="25" id="projectDetail" autocomplete="off" value=""></textarea>
</div>
<div id="cancelConfirm" >
	<p>Close dialog without saving?</p>
</div>
<div id="saveConfirm" >
	<p>Are you sure you want to save?</p>
</div>
</body>
</html>
